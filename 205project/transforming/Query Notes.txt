--2013 Accident

SELECT CaseNum as case_number, 2013 as case_year, Month as month, Day_Week as Day_of_Week, Hour as hour,Region as Region, 
Ve_Total as Num_Vehicles, ve_Forms as Num_ParkWork,Peds as Persons_Ped, PerNotMVIT as Persons_NotTransit, PERMVIT as Persons_InTransit,
Harm_EV as First_Harm_Event, MAN_COLL as Manner_Collision,
RelJct1 as Within_Interchange, RelJct2 as Relation_to_Junction,Typ_Int as Intersection_Type,Wrk_Zone as Work_Zone,
Weather as Weather1, Weather1 as Weather2, Weather2 as Weather3,
max_sev as Max_Injury, num_Inj as Num_Injury,alcohol as Alcohol_Involved 
FROM accident_project.accident_2013


SELECT CaseNum, 2013, month, Day_Week, Hour, Region, Ve_Total, ve_Forms, 
Peds, PerNotMVIT, PERMVIT, Harm_EV, MAN_COLL,
RelJct1, RelJct2, Typ_Int,Wrk_Zone,
Weather, Weather1, Weather2,
max_sev, num_Inj,alcohol
FROM accident_project.accident_2013



##POTENTIAL FOR EXTERNAL TABLE STUFF
create external table logdata(col1 string, col2 string) partitioned by (month string) location 's3://logdata'
alter table logdata add partition(month='april') location 's3://logdata/april'

hdfs://localhost:8020/user/w205/accident_project/2013/ACCIDENT


insert into table accident PARTITION (year = '2013')
SELECT case_number, 
file_year , 
month,
Day_of_Week,
Hour ,
Region,
Num_Vehicles ,
Num_ParkWork ,
Persons_Ped ,
Persons_NotTransit ,
Persons_Transit ,
First_Harm_Event,
Manner_Collision,
Within_Interchange,
Relation_to_Junction,
Intersection_Type,
Work_Zone,
Weather1,
Weather2,
Weather3,
Max_Injury,
Num_Injury ,
Alcohol_Involved
FROM T_Accident_2013




So
1) create target hive table accident
2) create YYYYAccident.py
3) create table t_Accident_YYYY
4) insert into accident for the partition 'YYYY'
5) drop table t_Accident_YYYY

OR

1) create hive table accident
2) create YYYYAccident.py
3) insert accident data into partiion YYYY